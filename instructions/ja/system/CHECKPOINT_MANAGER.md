# チェックポイント管理システム（簡潔版）

## 目的
タスクの進捗を最小限の出力で効果的に追跡・報告する

## 基本ルール
**すべての応答で以下を必ず実行すること：**

1. **応答の冒頭に以下の2行を表示**
```
`[現在ステップ/全体ステップ] 現在の状態 | 次: 次のアクション`
`📌 記録→checkpoint.log: [YYYY-MM-DD HH:MM:SS][TASK-xxxxxx][状態] メッセージ`
```

2. **2行目に表示した内容を実際にcheckpoint.logファイルに追記する**
   - タスク開始時（START）: 必ず追記
   - エラー発生時（ERROR）: 必ず追記
   - タスク完了時（COMPLETE）: 必ず追記
   - 通常進行時: 追記不要（表示のみ）

### 2行目の詳細
- タスク開始時: `📌 記録→checkpoint.log: [時刻][TASK-xxxxxx][START] タスク名 (推定Nステップ)`
- 通常進行時: `📌 記録→checkpoint.log: 開始時/エラー時/完了時のみ記録`
- エラー発生時: `📌 記録→checkpoint.log: [時刻][TASK-xxxxxx][ERROR] エラー内容`
- タスク完了時: `📌 記録→checkpoint.log: [時刻][TASK-xxxxxx][COMPLETE] 成果: 内容`

### ファイル記録ルール
重要なチェックポイントは `checkpoint.log` ファイルに追記する：
- タスク開始時
- エラー発生時
- タスク完了時

## 形式の詳細

### 日時の取得
- **重要**: 日時表記（YYYY-MM-DD HH:MM:SS）には必ず実際の現在日時を使用すること
- **実装方法**: Bashツールで `date '+%Y-%m-%d %H:%M:%S'` コマンドを実行して現在時刻を取得すること
- AIシステムが提供する現在日時情報を利用すること
- 例示やダミーの日時（2025-06-30 14:00:00など）は使用しないこと

### 起動時の手順
1. 新しいタスクを開始する際は、必ず最初に `date` コマンドで現在時刻を取得
2. 取得した時刻をチェックポイントログに使用
3. タスク完了時も同様に現在時刻を取得して記録

### 標準形式
- `[1/5] 分析完了 | 次: 設計`
- `[3/5] 実装中 | 次: テスト作成`
- `[5/5] 全完了 | 成果: 機能3つ実装`

### 特殊な状況
- 問題発生時: `[2/4] ⚠️ エラー発生 | 対処: 依存関係確認`
- 計画変更時: `[3/6] 計画修正 | 追加: データ検証ステップ`
- 待機時: `[2/3] ⏸️ 確認待ち | 要: ユーザーの判断`

## 適用タイミング

### 必須表示
1. タスク開始時
2. 各主要ステップ完了時
3. 問題発生時
4. タスク完了時

### 省略可能
- 同一ステップ内の小さな作業
- 単純な質問への回答
- 1ステップで完了する簡単なタスク

## ログファイル形式

### checkpoint.log の記録形式
```
[YYYY-MM-DD HH:MM:SS] [TASK-xxxxxx] [ステータス] メッセージ
```

### 記録例（実際の日時を使用）
```
[実際の日時] [TASK-8a3f2c] [START] Webアプリケーション開発開始 (推定5ステップ)
[実際の日時] [TASK-8a3f2c] [ERROR] 依存関係エラー: パッケージ不足
[実際の日時] [TASK-8a3f2c] [COMPLETE] 完了: API 3つ、テスト10個作成
```

## 実装例

### コーディングタスクの場合
```
`[1/4] 要件分析完了 | 次: 実装`
`📌 記録→checkpoint.log: [実際の日時][TASK-b5d7e1][START] Python関数実装 (4ステップ)`
コードの要件を理解しました。Pythonでデータ処理関数を実装します。

`[2/4] 実装完了 | 次: テスト`
`📌 記録→checkpoint.log: 開始時/エラー時/完了時のみ記録`
以下のコードを作成しました：
[コード]

`[3/4] テスト完了 | 次: ドキュメント`
`📌 記録→checkpoint.log: 開始時/エラー時/完了時のみ記録`
すべてのテストが成功しました。

`[4/4] 全完了 | 成果: 関数1つ、テスト3つ`
`📌 記録→checkpoint.log: [実際の日時][TASK-b5d7e1][COMPLETE] 成果: 関数1つ、テスト3つ`
実装が完了しました。
```

### 分析タスクの場合
```
`[1/3] データ確認完了 | 次: 分析実行`
データの構造を確認しました。

`[2/3] 分析完了 | 次: レポート作成`
主要な洞察を3つ発見しました。

`[3/3] 全完了 | 成果: 分析レポート`
レポートを作成しました。
```

## 重要な注意事項

1. **簡潔性を保つ**: ステータス行は1行のみ、20-30文字程度
2. **一貫性を保つ**: 同じタスク内では同じ全体ステップ数を維持
3. **可読性を優先**: 専門用語は避け、明確な日本語を使用

## 他の指示書との連携

このチェックポイント管理は、すべての指示書と組み合わせて使用されます。
各指示書の「具体的な指示」の主要ステップごとに進捗を報告してください。

---
## ライセンス情報
- **ライセンス**: Apache-2.0
- **参照元**: 
- **原著者**: dobachi
- **作成日**: 2025-06-30